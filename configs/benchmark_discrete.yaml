run_name: "benchmark_discrete"
logging:
  level: DEBUG
  output_file: "outputs/logs/${run_name}.log"
seed: 42
use_cache: true
reuse_cached_triplets: true
step_through: false

# Task configuration
tasks:
  defaults:
    max_docs: 200
    max_triplets: 50
    num_synthetic_docs: 0
    triplet_style: "lm_all"
    candidate_strategy: "multi"
    use_spurious_hard_negs: true
    embedding_preset: "hf_qwen3_embedding_8b"
    max_num_candidates: 10
    n_schema_samples: 10
    rate_triplet_quality: true
    min_triplet_quality: 2
    # Consistency validation (NEW) - ensures swapped (a,c,b) gets Invalid rating
    validate_consistency: true        # Enable consistency check (default: true)
    consistency_max_invalid: 1        # Swapped triplet must be rated â‰¤1 Invalid (default: 1, strict)
    prelabeled_selection: "hard_negatives"

  task_list:
    # - document_set: gsm8k
    #   criterion: final_expression
    #   triplet_style: "lm_summary_sentence"
    #   max_docs: 20
    #   max_triplets: 2

    - document_set: gsm8k
      criterion: arithmetic
      triplet_style: "lm_summary_dict"
      # # Specify custom presets for annotation
      # summary_generate_preset: "summary_generate_dict_gemini_flash"
      # summary_guidance_preset: "summary_guidance_generation_dict_gemini"  # Optional: override guidance preset
      max_docs: 50
      max_triplets: 10
      num_synthetic_docs: 5

    - document_set: gsm8k
      criterion: arithmetic
      triplet_style: "lm_tags"
      # # Specify custom presets for annotation
      # summary_generate_preset: "summary_generate_dict_gemini_flash"
      # summary_guidance_preset: "summary_guidance_generation_dict_gemini"  # Optional: override guidance preset
      max_docs: 50
      max_triplets: 10
      num_synthetic_docs: 5

# Evaluation methods configuration
methods_to_evaluate:
  bm25:
    - name: bm25_lexical
      preset: bm25_lexical
  reranker:
    - name: voyage_rerank_lite
      preset: voyage_rerank_2_5_lite

  # Document rewriting: Generate summaries and compare them
  document_rewrite:
    # Embeddings over summaries
    - name: dr_gemini_lite_openai_small
      embedding_preset: openai_embedding_small
      summary_preset: document_summary_gemini_flash
  lm_judge_triplet:
    # - name: gemini_flash_triplet_with_annotation
    #   preset: lmjudge_triplet_plaintext_binaryhard_with_annotation_gemini_flash
    - name: gemini_flash_triplet
      preset: lmjudge_triplet_plaintext_binaryhard_gemini_flash
    # - name: gemini_pro_triplet_with_annotation
    #   preset: lmjudge_triplet_plaintext_binaryhard_with_annotation_gemini_pro
    # - name: gemini_pro_triplet_no_annotation
    #   preset: lmjudge_triplet_plaintext_binaryhard_gemini_pro
  # pseudologit:

  #   # - name: pseudologit_n3
  #   #   preset: pseudologit_gemini_n3
  #   #   classes_file: prompts/custom/gsm8k_1_classes.json

  #   # - name: pseudologit_n10
  #   #   preset: pseudologit_gemini_n10
  #   #   classes_file: prompts/custom/gsm8k_classes.json



  # query_relevance_vectors:
  #   - name: qrv_gemini_openai_k10_dev25
  #     expansion_preset: query_relevance_scores_gemini
  #     embedding_preset: openai_embedding_small
  #     num_expansions: 10
  #     dev_set_size: 5
  # in_one_word:
  #   - name: inoneword_custom_categories
  #     preset: inoneword_hf_qwen3_8b
  #     categories: ["addition", "subtraction", "multiplication", "division", "other"]
  #     category_context: "Classify the math problem type"



  embeddings:
    - name: qwen3_8b_with_instructions
      preset: instr_hf_qwen3_embedding_8b
    - name: qwen3_8b_no_instructions
      preset: hf_qwen3_embedding_8b
