# Test configuration for query expansion with different model combinations
# Tests various combinations of summary generation models (rewriters) and retrieval methods
run_name: "test_qe_combinations"
logging:
  level: INFO
  output_file: "outputs/logs/${run_name}.log"
seed: 42
use_cache: true
step_through: false

# Task configuration (small scale for testing)
tasks:
  defaults:
    max_docs: 50
    max_triplets: 10
    num_synthetic_docs: 5
    triplet_style: "lm_all"
    add_synthetic_docs: false
    candidate_strategy: "multi"
    use_spurious_hard_negs: true
    embedding_preset: "hf_qwen3_embedding_8b"
    max_num_candidates: 5
    n_schema_samples: 4
    rate_triplet_quality: false
    min_triplet_quality: null

  task_list:
    - document_set: gsm8k
      criterion: arithmetic

# Evaluation methods - testing different combinations
methods_to_evaluate:
  # Baselines for comparison
  bm25:
    - name: bm25_raw

  embeddings:
    - name: qwen3_8b_raw
      preset: hf_qwen3_embedding_8b

  # Query expansion with different rewriter models + BM25
  query_expansion:
    # Gemini Flash Lite (cheapest/fastest) + BM25
    - name: qe_gemini_lite_bm25
      retrieval_method: bm25
      summary_preset: query_expansion_summary_gemini

    # Gemini Flash (better quality) + BM25
    - name: qe_gemini_flash_bm25
      retrieval_method: bm25
      summary_preset: query_expansion_summary_gemini_flash

    # Claude Haiku (cheap alternative) + BM25
    - name: qe_claude_haiku_bm25
      retrieval_method: bm25
      summary_preset: query_expansion_summary_claude_haiku

    # Gemini Flash Lite + OpenAI embeddings (small)
    - name: qe_gemini_lite_openai_small
      retrieval_method: embeddings
      summary_preset: query_expansion_summary_gemini
      embedding_preset: openai_embedding_small

    # Gemini Flash Lite + OpenAI embeddings (large)
    - name: qe_gemini_lite_openai_large
      retrieval_method: embeddings
      summary_preset: query_expansion_summary_gemini
      embedding_preset: openai_embedding_large

    # Gemini Flash Lite + Qwen embeddings
    - name: qe_gemini_lite_qwen_8b
      retrieval_method: embeddings
      summary_preset: query_expansion_summary_gemini
      embedding_preset: hf_qwen3_embedding_8b

    # Claude Haiku + Qwen embeddings (alternative combination)
    - name: qe_claude_haiku_qwen_8b
      retrieval_method: embeddings
      summary_preset: query_expansion_summary_claude_haiku
      embedding_preset: hf_qwen3_embedding_8b

    # Gemini Flash + Qwen embeddings (higher quality rewriter)
    - name: qe_gemini_flash_qwen_8b
      retrieval_method: embeddings
      summary_preset: query_expansion_summary_gemini_flash
      embedding_preset: hf_qwen3_embedding_8b
