# Benchmark configuration for MoralFables evaluation
# Goal: Test prelabeled triplet generation with all 4 moral criteria
run_name: "benchmark_fuzzy"
logging:
  level: DEBUG
  output_file: "temp.${run_name}.log"
seed: 42
use_cache: true
step_through: false

# Task configuration
tasks:
  defaults:
    max_docs: 100  # Small dataset for quick testing
    max_triplets: 5

    num_synthetic_docs: 0
    triplet_style: "lm_all"
    add_synthetic_docs: false

    candidate_strategy: "multi"  # BM25 + embedding + Jaccard
    use_spurious_hard_negs: true   # Include spurious hard negatives in candidate pool
    embedding_preset: "hf_qwen3_embedding_8b"
    max_num_candidates: 10  # Max candidates shown to LM judge (per strategy for 'multi')
    n_schema_samples: 10
    rate_triplet_quality: true
    min_triplet_quality: 2 # 3  # Filter to keep only triplets with quality >= 3 (trivial or ideal)

    prelabeled_selection: "hard_negatives"  # BM25-based selection

  task_list:
    # Test all 4 moral criteria with prelabeled triplets
    - document_set: rocstories
      criterion: setting
      max_triplets: 10

# Evaluation methods configuration
methods_to_evaluate:
  # Method 1: BM25 baseline (lexical similarity)
  bm25:
    - name: bm25_lexical

  # Method 2: LM Judge Triplet (Gemini direct comparison)
  lm_judge_triplet:
    # - name: gemini_flash_lite_triplet_with_annotation
    #   preset: lmjudge_triplet_plaintext_binaryhard_with_annotation_gemini
    # - name: gemini_flash_lite_triplet_no_annotation
    #   preset: lmjudge_triplet_plaintext_binaryhard_gemini
    - name: gemini_flash_triplet_with_annotation
      preset: lmjudge_triplet_plaintext_binaryhard_with_annotation_gemini_flash
    - name: gemini_flash_triplet_no_annotation
      preset: lmjudge_triplet_plaintext_binaryhard_gemini_flash

  # Method 3 & 4: Embeddings with/without instructions
  embeddings:
    # WITH instruction prefix (default)
    - name: qwen3_8b_with_instructions
      preset: hf_qwen3_embedding_8b
      # Uses default instruction: "Represent this query for retrieval: "

    # WITHOUT instruction prefix (override to null)
    - name: qwen3_8b_no_instructions
      preset: hf_qwen3_embedding_8b
      preset_overrides:
        embed_query_instr_template: null  # Remove instruction prefix
